---
title: Apache Kafka® MirrorMaker 2 log analysis using the offset sync tool
sidebar_label: Offset sync log analysis
---

Analyze key log messages during data synchronization with Apache Kafka® MirrorMaker 2 using Aiven’s offset sync inspection tool.
This tool tracks the progress of synchronization between source and destination clusters.
You can run it locally after setting up the required environment to review offset
syncing between source and target Apache Kafka topics. The tool generates messages
that indicate partition health and highlight when intervention is needed, making it
particularly useful during large data migrations.

## Prerequisites

Before you download and run the tool, ensure you have the following:

- Basic understanding of Kafka shell tools.
- A valid Apache Kafka MirrorMaker 2 configuration file with the necessary source and
  target cluster connectivity fields.

## Download the offset sync inspection tool

Download and run the **offset sync inspection tool** to analyze offset syncing in
MirrorMaker 2:

- [Download the offset sync inspection tool](https://github.com/aiven/kafka/releases/tag/mm2-offset-sync-inspector-0.1)

## Run the tool

The offset sync inspection tool outputs logs in CSV format. Use the logs to check the
sync status and detect any issues with the offset syncing process.

### Example command

Run the tool using the following command:

```bash
<extracted tgz>/bin/kafka-mirrormaker-offset-sync-inspector.sh --mm2-config <path-to-config-file>
```

Parameter:

- `--mm2-config <path-to-config-file>`: Specifies the path to the MirrorMaker 2
  configuration file. This file contains the connection details for the source and
  target Apache Kafka clusters.

To view all available options, run the help command:

```bash
./bin/kafka-mirrormaker-offset-sync-inspector.sh --help
```

## Log messages and actions

Below are common log messages generated by the tool, what they mean, and recommended
actions. If any issues arise, [create a support ticket](/docs/platform/howto/support) or
email [Aiven Support](mailto:support@aiven.io).

<table>
  <tr>
    <th>Message ID</th>
    <th>Script message</th>
    <th>What it means</th>
    <th>Customer action</th>
    <th>How to inspect</th>
    <th>How to analyze inspection</th>
    <th>Issue with Apache Kafka or MirrorMaker 2</th>
  </tr>
  <tr>
    <td>1</td>
    <td>Successfully synced, operating normally.</td>
    <td>Data and offsets are successfully migrated. Consumers consume from the synced
        offsets with minimal redelivery.</td>
    <td>No action required</td>
    <td>Not required</td>
    <td>Not required</td>
    <td>No</td>
  </tr>
  <tr>
    <td>2</td>
    <td>Intentionally not synced because the source partition is empty. Other partitions
        in this group are synced.</td>
    <td>The source partition has no data, so MirrorMaker 2 skips syncing it. Consumers
        start from the beginning when new data arrives.</td>
    <td>No action required</td>
    <td>Not required</td>
    <td>Not required</td>
    <td>No</td>
  </tr>
  <tr>
    <td>3</td>
    <td>Intentionally not synced because the source partition is empty. Other partitions
        in this group are not synced.</td>
    <td>The source partition has no data, so MirrorMaker 2 skips syncing it. Consumers
        start from the beginning when new data arrives.</td>
    <td>No action required</td>
    <td>Not required</td>
    <td>Not required</td>
    <td>No</td>
  </tr>
  <tr>
    <td>4</td>
    <td>Intentionally not synced because the source group is too old. Other partitions
        in this group are synced.</td>
    <td>The source partition has newer data than the committed offset for the consumer
        group. Consumers will start from the beginning when new data arrives.</td>
    <td>No action required</td>
    <td>Not required</td>
    <td>Not required</td>
    <td>No</td>
  </tr>
  <tr>
    <td>5</td>
    <td>Intentionally not synced because the source group is too old. Other partitions
        in this group are not synced.</td>
    <td>The source partition has newer data than the committed offset for the consumer
        group. Consumers will start from the beginning when new data arrives.</td>
    <td>No action required</td>
    <td>Not required</td>
    <td>Not required</td>
    <td>No</td>
  </tr>
  <tr>
    <td>6</td>
    <td>Erroneously not synced. Source partition has data, and other partitions for this
        group are synced.</td>
    <td>There is an offset syncing issue. Consumers start from the beginning
        when new data arrives.</td>
    <td><a href="/docs/platform/howto/support">Create a support ticket</a> or
        email <a href="mailto:support@aiven.io">Aiven Support</a>.</td>
    <td>
      <ul>
        <li>Use <code>kafka-get-offsets</code> to compare the earliest and latest
            offsets in the source and target topics.</li>
        <li>Check the source Kafka dashboard for throughput on the partition.</li>
        <li>Use <code>kafka-console-consumer</code> to inspect the offset syncs topic
            and grep for the topic-partition key.</li>
        <li>Enable TRACE logging for OffsetSyncStore in MirrorMaker 2 to review
            translation activity.</li>
      </ul>
    </td>
    <td>
      <ul>
        <li>The partition has little or no data, causing dropped offset syncs.</li>
        <li>Zero throughput prevents syncs from being generated.</li>
        <li>The MirrorSourceTask is not emitting syncs, or the MirrorCheckpointTask is
        expiring them.</li>
      </ul>
    </td>
    <td>Yes</td>
  </tr>
  <tr>
    <td>7</td>
    <td>Erroneously not synced. Source partition has data, and other partitions for
        this group are not synced.</td>
    <td>There is a systematic failure affecting all partitions in this topic.
        Consumers start from the beginning when new data arrives.</td>
    <td><a href="/docs/platform/howto/support">Create a support ticket</a> or
        email <a href="mailto:support@aiven.io">Aiven Support</a>.</td>
    <td>
      <ul>
        <li>Run per-partition diagnostics and compare offsets for the affected
            partitions.</li>
        <li>Use <code>kafka-get-offsets</code> and inspect the sync activity in the
            logs.</li>
      </ul>
    </td>
    <td>Investigate sync failures across partitions.</td>
    <td>Yes</td>
  </tr>
</table>
